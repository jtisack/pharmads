<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.542">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pharmads-2024 - Storytelling with Shiny</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#about-me" id="toc-about-me" class="nav-link" data-scroll-target="#about-me">About me</a></li>
  <li><a href="#why-shiny" id="toc-why-shiny" class="nav-link" data-scroll-target="#why-shiny">Why Shiny?</a></li>
  <li><a href="#survey" id="toc-survey" class="nav-link" data-scroll-target="#survey">Survey</a></li>
  </ul></li>
  <li><a href="#following-along-during-the-course" id="toc-following-along-during-the-course" class="nav-link" data-scroll-target="#following-along-during-the-course">Following along during the Course</a></li>
  <li><a href="#what-is-shiny" id="toc-what-is-shiny" class="nav-link" data-scroll-target="#what-is-shiny">What is Shiny?</a></li>
  <li><a href="#shiny-architecture" id="toc-shiny-architecture" class="nav-link" data-scroll-target="#shiny-architecture">Shiny Architecture</a>
  <ul class="collapse">
  <li><a href="#typical-web-app-architecture" id="toc-typical-web-app-architecture" class="nav-link" data-scroll-target="#typical-web-app-architecture">Typical Web App Architecture</a></li>
  <li><a href="#structure-of-a-shiny-app" id="toc-structure-of-a-shiny-app" class="nav-link" data-scroll-target="#structure-of-a-shiny-app">Structure of a Shiny App</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#simple-shiny-app-example" id="toc-simple-shiny-app-example" class="nav-link" data-scroll-target="#simple-shiny-app-example">Simple Shiny App Example</a></li>
  <li><a href="#k-means-clustering-example" id="toc-k-means-clustering-example" class="nav-link" data-scroll-target="#k-means-clustering-example">K-Means Clustering Example</a></li>
  </ul></li>
  <li><a href="#user-interface" id="toc-user-interface" class="nav-link" data-scroll-target="#user-interface">User Interface</a>
  <ul class="collapse">
  <li><a href="#the-user-interface-is-static" id="toc-the-user-interface-is-static" class="nav-link" data-scroll-target="#the-user-interface-is-static">The user interface is static</a></li>
  </ul></li>
  <li><a href="#server-and-reactivity" id="toc-server-and-reactivity" class="nav-link" data-scroll-target="#server-and-reactivity">Server and Reactivity</a>
  <ul class="collapse">
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  </ul></li>
  <li><a href="#advanced-ui" id="toc-advanced-ui" class="nav-link" data-scroll-target="#advanced-ui">Advanced UI</a>
  <ul class="collapse">
  <li><a href="#bslib" id="toc-bslib" class="nav-link" data-scroll-target="#bslib">Bslib</a></li>
  <li><a href="#shinyuieditor" id="toc-shinyuieditor" class="nav-link" data-scroll-target="#shinyuieditor">ShinyUiEditor</a></li>
  <li><a href="#htmlwidgets" id="toc-htmlwidgets" class="nav-link" data-scroll-target="#htmlwidgets">Htmlwidgets</a></li>
  <li><a href="#many-many-other-shiny-packages" id="toc-many-many-other-shiny-packages" class="nav-link" data-scroll-target="#many-many-other-shiny-packages">Many, many other Shiny packages</a></li>
  </ul></li>
  <li><a href="#deployment" id="toc-deployment" class="nav-link" data-scroll-target="#deployment">Deployment</a>
  <ul class="collapse">
  <li><a href="#shiny-server" id="toc-shiny-server" class="nav-link" data-scroll-target="#shiny-server">Shiny Server</a></li>
  <li><a href="#shinylive" id="toc-shinylive" class="nav-link" data-scroll-target="#shinylive">Shinylive</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Storytelling with Shiny</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>These materials provide an introduction to using R Shiny for data storytelling. They were prepared for the Mastering Storytelling for Pharma Data Science Professionals short course at the <a href="https://phds.nestat.org/" target="_blank">Pharmaceutical Data Science Conference 2024</a> held at University of Connecticut in March 2024.</p>
<p>The materials were prepared by <a href="https://www.linkedin.com/in/jtisack" target="_blank">Jonathan Tisack</a> (BeiGene) and <a href="https://www.linkedin.com/in/zhiwei-yin-0ba00569/" target="_blank">Dr.&nbsp;Zhiwei Yin</a> (Bristol Myers Squibb).</p>
<section id="about-me" class="level3">
<h3 class="anchored" data-anchor-id="about-me">About me</h3>
<ul>
<li><p>Jonathan Tisack, M.S. Mathematics</p></li>
<li><p>Data Scientist at BeiGene</p></li>
<li><p>R/Shiny user for over 5 years</p></li>
</ul>
</section>
<section id="why-shiny" class="level3">
<h3 class="anchored" data-anchor-id="why-shiny">Why Shiny?</h3>
<ul>
<li><p>Shiny enables any R user to bring their work to the web</p></li>
<li><p>Many great data visualization technologies are made for the web (<a href="https://d3js.org/">D3</a>, <a href="https://plotly.com/javascript/">Plotly</a>)</p></li>
<li><p>Web technologies allow for interactivity (Example: <a href="https://projects.fivethirtyeight.com/2023-march-madness-predictions/">538 March Madness Predictions</a>)</p></li>
<li><p><a href="https://www.r-consortium.org/blog/2022/12/07/update-successful-r-based-package-submission-with-shiny-component-to-fda">Shiny in Regulatory Submission</a></p></li>
</ul>
</section>
<section id="survey" class="level3">
<h3 class="anchored" data-anchor-id="survey">Survey</h3>
<p>Rate your experience level with R:</p>
<ol type="1">
<li><p>I barely know any R</p></li>
<li><p>I know enough R to get around</p></li>
<li><p>I know R inside out</p></li>
</ol>
<p>Have you used Shiny before?</p>
</section>
</section>
<section id="following-along-during-the-course" class="level2">
<h2 class="anchored" data-anchor-id="following-along-during-the-course">Following along during the Course</h2>
<p>Several options for running the code during the course:</p>
<ol type="1">
<li><p><a href="https://shinylive.io/r/editor/">Shinylive</a> is now the easiest way to run a simple Shiny app. Shiny will run in your browser alongside a basic editor.</p>
<ul>
<li>This works using <a href="https://docs.r-wasm.org/">WebR</a>, which is a version for R compiled for the browser using WebAssembly. This is still in early stages and isn’t recommended for production use. <a href="https://webr.r-wasm.org/latest/">Try it here</a>.</li>
</ul></li>
<li><p><a href="https://posit.co/products/open-source/rstudio/">RStudio IDE</a> is the best way to do Shiny development. There are two ways to use it:</p>
<ol type="1">
<li><a href="https://posit.co/downloads/">Download and install</a> RStudio Desktop.</li>
<li>Run it through your browser with a free <a href="https://posit.cloud/plans/free">Posit Cloud</a> account.</li>
</ol></li>
</ol>
</section>
<section id="what-is-shiny" class="level2">
<h2 class="anchored" data-anchor-id="what-is-shiny">What is Shiny?</h2>
<ul>
<li><p><strong>Shiny Basics</strong></p>
<ul>
<li>R Shiny is an open source R package that enables easy creation of interactive web applications. It is also available for Python, but the package ecosystem is far less developed.</li>
<li>Posit (formerly RStudio) created Shiny and continues to lead development.</li>
<li>No web development skills required. Shiny generates all the HTML, CSS, and JavaScript for the web app.</li>
<li>Basic R proficiency is all that is required to use R Shiny.</li>
<li>Shiny has a very active community of developers. There are many, many additional R packages that enhance Shiny.</li>
</ul></li>
<li><p><strong>Use Cases</strong></p>
<ul>
<li>Posit has many examples in the <a href="https://shiny.posit.co/r/gallery/">Shiny Gallery</a></li>
<li>Interactive data visualization and exploration. Replace a giant PDF of plots with a single app.</li>
<li>Customized report generation. Allow users to generate their own reports or tables.</li>
<li>Deploying R scripts for non-technical users. Make a basic interface that will allow users to interact with your code.</li>
<li>Make your reports interactive. Shiny can be integrated into RMarkdown/Quarto documents. <a href="https://www.youtube.com/watch?v=1mq9YgAEdXU">R/Pharma talk by Max Kuhn on using Shinylive in his new book.</a></li>
<li>Make a front-end interface for a large language model.</li>
<li>Education tools to explain statistical concepts.</li>
<li><a href="https://shiny.posit.co/r/articles/build/gadgets/">RStudio IDE gadgets</a>.</li>
</ul></li>
<li><p><strong>Learning Resources</strong></p>
<p>Shiny has been around for 10+ years and there are many learning resources available.</p>
<ul>
<li><a href="https://shiny.posit.co/">R Shiny Documentation</a> - Includes articles explaining specific topics, as well as a full function reference.</li>
<li><a href="https://mastering-shiny.org/">Mastering Shiny book</a> - A book by Hadley Wickham, freely available online, that covers all Shiny features in an approachable manner.</li>
<li><a href="https://shiny.posit.co/r/articles/start/cheatsheet/">Shiny Cheat Sheet</a></li>
</ul></li>
</ul>
</section>
<section id="shiny-architecture" class="level2">
<h2 class="anchored" data-anchor-id="shiny-architecture">Shiny Architecture</h2>
<section id="typical-web-app-architecture" class="level3">
<h3 class="anchored" data-anchor-id="typical-web-app-architecture">Typical Web App Architecture</h3>
<p><img src="images/clipboard-1969708342.png" class="img-fluid"></p>
</section>
<section id="structure-of-a-shiny-app" class="level3">
<h3 class="anchored" data-anchor-id="structure-of-a-shiny-app">Structure of a Shiny App</h3>
<p>Typically a shiny app is written in an R file called <code>app.R</code>. Within <code>app.R</code> there are three components:</p>
<ol type="1">
<li><p>A user interface object, typically named <code>ui</code>. This object controls the layout of the app.</p></li>
<li><p>A <code>server</code> function. This function controls the interactive component of the app. It is where your typical R code is executed, such as code that does data transformations and generates visualizations.</p></li>
<li><p>A call to the shiny package function <code>shinyApp()</code>, which takes the <code>ui</code> object and <code>server</code> function as arguments.</p></li>
</ol>
<p>Here is a minimal shiny app:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Hello, world!"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<section id="simple-shiny-app-example" class="level3">
<h3 class="anchored" data-anchor-id="simple-shiny-app-example">Simple Shiny App Example</h3>
<ul>
<li><p>Simple Shiny App (<a href="https://shinylive.io/r/editor/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAYgAIBxAGyICMpHaA3KAJwEsoLRnADOtAlAi0A5kVoALODzgAdCABM4AMygBXRqQD6UgDwBaWgCYADNbVq6AEW18IcWqUW0AqgEk1uny05rQsRESkIqQ8aAAKUNJwABRqtLQQuvD8BL4QqLqkSQDkEEW4tEUAcpksSrREWvUsImW0mjr6RhAAlLiptKjMpADyBfmFRYMRRd1qsxAOtM5aru6e7iJKnHXEmmqbPNs8wRZauhAEpHwkSa7j5URjBd20IP2PpOMAJFOkJ7TKDRKWJDJJvKRpBR8KJJHjnPhaW55ApfHrzNIAX3mGPsEDoWDgpF0PCkUFoAGV5K4AJ60NCoJoAKzgl32VIg1IAgugkoFaABeWiBcoHI4C2iipTdMAYgC6QA">Open in Shinylive editor</a>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Global variables can go here</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>default_n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the UI</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">bootstrapPage</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">numericInput</span>(<span class="st">'n'</span>, <span class="st">'Number of obs'</span>, default_n),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotOutput</span>(<span class="st">'plot'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the server code</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(<span class="fu">runif</span>(input<span class="sc">$</span>n))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a Shiny app object</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
</ul>
</section>
<section id="k-means-clustering-example" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering-example">K-Means Clustering Example</h3>
<ul>
<li><p><a href="https://shiny.posit.co/r/gallery/start-simple/kmeans-example/">K-Means Clustering Example</a> (<a href="https://shinylive.io/r/editor/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAGwEsAjAJykYE8AKAZwAtaJWAlAB0IIgMQACANYBaeFAicJJaqwkB3IoylL1tUtwkQArvEa0CUahIBuLWlHrU4nXOImciEgCYkA5KQSAOa0NnASBuHGnHCMEdzhRKiktCQRXjHOBKTuUBKW5EFaFla29o7OInaMSgA8Mh5wpN60AGat7NDwnOy05pwCuBJCYADKqHAEtC4jwqImtBL1EqhQQXAA6vrco7TecPQs7CISEglQ+4wACgpw1Ox+AJL90nJwCkoE1NHk5hBBfkGJw8ewOLBuEDuxwgp1OmUmpEeEFQxlIDwAHsRqH4hn4ABoSABq5SccBxZRqQJhsPh2SRKLRflYWPJfgAmkSSc5ydVXI0suRvBIALwUzjAYAAJgAutKqbCjKZYhZ6aiHl8frFOKyAMLfTi-fJEYxkckAZiGMD4IokAEZLVB0TaAJxzU7yiQwKB8CFQ4GnVDUIikADyqIZD0DwdtgOBczmIhEMUYYTiy1aJuyqQgvWRqKGxtIDKGMU4nGzAgkIET1MkOqIMHofHCkX5CLgQuqDlJSj4pC8eUh6h8UFIeVazHgwNpgoAIqO8stGO8s2F2NXqac+rRxUMCLmGQASTFEahDPhH5mngTS4EAXwT1I1Bq1Sway6gq7g6-90nkii4O5228ecx3YQYJAvVFD2fX4BnvR9TkLI8o1IW03wkZcIEuK4gzRDcFVWZxSHIdh9xGMQAFEABZbQAQVtHURiGCizQAdjYyiACEAA5mOGMAxGo2c6IAMWouj+Io50eOoyi6LNZjf1OCjRNEtjRIABk0qTBLUtSzUUvABLEOiADYAFYzMlPjjNUtieNtLjRN0sRnXcjzZkQ2FVkYdgvTiUV9wsjB7QkajQqGTShltAQ3R8vDAIFDtQKgcC3E3BVTixG1YK1cCYP1X4MqywiCEMUVJWi-I4CdUUzXigMiD7Ho8pqAqCAoOChlQcqbWovdav6oZqHUIVRWo+KHxrO8azrD9yAkUZeH4CQ0FQCQZC2mQkxW1g6PQdhjEWUVjpLWJUxtZNUzmMA72lIA">Open in Shinylive editor</a>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># k-means only works with numerical variables,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># so don't give the user the option to select</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a categorical variable</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(iris), <span class="st">"Species"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">pageWithSidebar</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">headerPanel</span>(<span class="st">'Iris k-means clustering'</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarPanel</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">'xcol'</span>, <span class="st">'X Variable'</span>, vars),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">'ycol'</span>, <span class="st">'Y Variable'</span>, vars, <span class="at">selected =</span> vars[[<span class="dv">2</span>]]),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">numericInput</span>(<span class="st">'clusters'</span>, <span class="st">'Cluster count'</span>, <span class="dv">3</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">9</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mainPanel</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plotOutput</span>(<span class="st">'plot1'</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the selected variables into a new data frame</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  selectedData <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    iris[, <span class="fu">c</span>(input<span class="sc">$</span>xcol, input<span class="sc">$</span>ycol)]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  clusters <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kmeans</span>(<span class="fu">selectedData</span>(), input<span class="sc">$</span>clusters)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>plot1 <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#984EA3"</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#FF7F00"</span>, <span class="st">"#FFFF33"</span>, <span class="st">"#A65628"</span>, <span class="st">"#F781BF"</span>, <span class="st">"#999999"</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">selectedData</span>(),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">clusters</span>()<span class="sc">$</span>cluster,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">3</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(<span class="fu">clusters</span>()<span class="sc">$</span>centers, <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Shiny app ----</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shiny Options
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can change the way a Shiny app behaves by setting options (<a href="https://shiny.posit.co/r/reference/shiny/1.7.0/shinyoptions">full documentation</a>). Some useful ones for development are:</p>
<ul>
<li><p>options(shiny.error = browser) will open the RStudio debugger when the app encounters an error</p></li>
<li><p>options(shiny.autoreload = TRUE) will monitor files in your working directory and auto reload the app whenever a file change is detected. Can be configured to monitor specific file patterns.</p></li>
<li><p>options(shiny.trace = TRUE) prints messages sent between the Shiny server and the browser. Results in a lot of output but good for debugging.</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="user-interface" class="level2">
<h2 class="anchored" data-anchor-id="user-interface">User Interface</h2>
<ul>
<li><p>The UI is mainly composed of <strong>inputs</strong> and <strong>outputs</strong>.</p></li>
<li><p><strong>Inputs</strong> are widgets that get input from the user</p>
<p><img src="images/clipboard-1862809380.png" class="img-fluid"></p></li>
<li><p><strong>Outputs</strong> are placeholders that are later filled in by the <code>server</code> function. Each output has a corresponding render function in the <code>server</code>.</p>
<p><img src="images/clipboard-235306912.png" class="img-fluid"></p></li>
</ul>
<section id="the-user-interface-is-static" class="level3">
<h3 class="anchored" data-anchor-id="the-user-interface-is-static">The user interface is static</h3>
<p>Code in the user interface is only run once. To illustrate this, try inspecting the ui object.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Structure of a UI object
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">numericInput</span>(<span class="st">'n'</span>, <span class="st">'Number of obs'</span>, <span class="dv">100</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotOutput</span>(<span class="st">'plot'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ui)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;div class="container-fluid"&gt;
  &lt;div class="form-group shiny-input-container"&gt;
    &lt;label class="control-label" id="n-label" for="n"&gt;Number of obs&lt;/label&gt;
    &lt;input id="n" type="number" class="shiny-input-number form-control" value="100"/&gt;
  &lt;/div&gt;
  &lt;div class="shiny-plot-output html-fill-item" id="plot" style="width:100%;height:400px;"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ui)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ :List of 10
  ..$ name      : chr "jquery"
  ..$ version   : chr "3.6.0"
  ..$ src       :List of 1
  .. ..$ file: chr "www/shared"
  ..$ meta      : NULL
  ..$ script    : chr "jquery.min.js"
  ..$ stylesheet: NULL
  ..$ head      : NULL
  ..$ attachment: NULL
  ..$ package   : chr "shiny"
  ..$ all_files : logi FALSE
  ..- attr(*, "class")= chr "html_dependency"
 $ : NULL
 $ : NULL
 $ :List of 1
  ..$ :List of 3
  .. ..$ name    : chr "div"
  .. ..$ attribs :List of 1
  .. .. ..$ class: chr "container-fluid"
  .. ..$ children:List of 2
  .. .. ..$ :List of 3
  .. .. .. ..$ name    : chr "div"
  .. .. .. ..$ attribs :List of 1
  .. .. .. .. ..$ class: chr "form-group shiny-input-container"
  .. .. .. ..$ children:List of 2
  .. .. .. .. ..$ :List of 3
  .. .. .. .. .. ..$ name    : chr "label"
  .. .. .. .. .. ..$ attribs :List of 3
  .. .. .. .. .. .. ..$ class: chr "control-label"
  .. .. .. .. .. .. ..$ id   : chr "n-label"
  .. .. .. .. .. .. ..$ for  : chr "n"
  .. .. .. .. .. ..$ children:List of 1
  .. .. .. .. .. .. ..$ : chr "Number of obs"
  .. .. .. .. .. ..- attr(*, "class")= chr "shiny.tag"
  .. .. .. .. ..$ :List of 3
  .. .. .. .. .. ..$ name    : chr "input"
  .. .. .. .. .. ..$ attribs :List of 4
  .. .. .. .. .. .. ..$ id   : chr "n"
  .. .. .. .. .. .. ..$ type : chr "number"
  .. .. .. .. .. .. ..$ class: chr "shiny-input-number form-control"
  .. .. .. .. .. .. ..$ value: chr "100"
  .. .. .. .. .. ..$ children: list()
  .. .. .. .. .. ..- attr(*, "class")= chr "shiny.tag"
  .. .. .. ..- attr(*, "class")= chr "shiny.tag"
  .. .. ..$ :List of 3
  .. .. .. ..$ name    : chr "div"
  .. .. .. ..$ attribs :List of 4
  .. .. .. .. ..$ id   : chr "plot"
  .. .. .. .. ..$ class: chr "shiny-plot-output"
  .. .. .. .. ..$ style: chr "width:100%;height:400px;"
  .. .. .. .. ..$ class: chr "html-fill-item"
  .. .. .. ..$ children: list()
  .. .. .. ..- attr(*, "class")= chr "shiny.tag"
  .. ..- attr(*, "class")= chr "shiny.tag"
 - attr(*, "class")= chr [1:2] "shiny.tag.list" "list"
 - attr(*, "html_dependencies")=List of 1
  ..$ :function ()  
  .. ..- attr(*, "class")= chr "shiny.tag.function"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="server-and-reactivity" class="level2">
<h2 class="anchored" data-anchor-id="server-and-reactivity">Server and Reactivity</h2>
<ul>
<li><p>Shiny server logic is based on a reactive programming paradigm.</p></li>
<li><p>Reactivity means that when an input changes, all dependent outputs are recalculated.</p></li>
<li><p>Server logic is expressed in the <code>server(input, output, session)</code> function, which Shiny invokes each time a new <em>session</em> starts.</p>
<ul>
<li><p>A session starts whenever a user opens the shiny app. A single shiny server may run many sessions from different (or the same) users.</p></li>
<li><p>The parameters of the server function (input, output, session) are separate for each session.</p></li>
</ul></li>
<li><p>The three parameters of the <code>server</code> function are:</p>
<ul>
<li><p><code>input</code>: A read-only list of the inputs defined in the UI, and their current values. This is how the server function can use the inputs defined in the UI.</p></li>
<li><p><code>output</code>: A list of outputs defined in the UI. This is how a user defines the app’s outputs, and it must always be used with a <code>render</code> function.</p></li>
<li><p><code>session</code>: An optional parameter with a lot of functionality, mainly for advanced users. See the <a href="https://shiny.posit.co/r/reference/shiny/latest/session.html">documentation</a> for details.</p></li>
</ul></li>
<li><p>Code in the server function is not run linearly, it is <strong>lazy</strong> and <strong>reactive</strong>.</p>
<ul>
<li><p><strong>Lazy</strong> means that that it is only run when needed. If a user can’t see an output on their screen, the code to generate that output is not run. If an app has multiple pages/tabs, the code for an output isn’t run until the user navigates to that tab.</p></li>
<li><p><strong>Reactive</strong> means that when an input is used in the code that defines an output, that output takes a <strong>dependency</strong> on the input. Whenever a dependency of an output changes, the output code will be re-run.</p></li>
</ul></li>
<li><p>This means that the order of code in the server function does not matter. Code is run when needed, based on the <strong>reactive graph.</strong></p>
<ul>
<li><p>Examples from <a href="https://shiny.posit.co/r/articles/build/reactivity-overview/">Posit Documentation</a>.</p></li>
<li><p>A simple reactive graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>distPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(<span class="fu">rnorm</span>(input<span class="sc">$</span>obs))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1863259463.png" class="img-fluid"></p></li>
<li><p>A more complex reactive graph. Outputs can depend on any combination of inputs. Dependencies can overlap between outputs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>plotOut <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(faithful<span class="sc">$</span>eruptions, <span class="at">breaks =</span> <span class="fu">as.numeric</span>(input<span class="sc">$</span>nBreaks))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>individualObs)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rug</span>(faithful<span class="sc">$</span>eruptions)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>tableOut <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>individualObs)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>      faithful</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-3517538182.png" class="img-fluid"></p></li>
<li><p>A reactive graph with an intermediate reactive expression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fib <span class="ot">&lt;-</span> <span class="cf">function</span>(n) <span class="fu">ifelse</span>(n<span class="sc">&lt;</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="fu">fib</span>(n<span class="dv">-1</span>)<span class="sc">+</span><span class="fu">fib</span>(n<span class="dv">-2</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  currentFib         <span class="ot">&lt;-</span> <span class="fu">reactive</span>({ <span class="fu">fib</span>(<span class="fu">as.numeric</span>(input<span class="sc">$</span>n)) })</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nthValue    <span class="ot">&lt;-</span> <span class="fu">renderText</span>({ <span class="fu">currentFib</span>() })</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nthValueInv <span class="ot">&lt;-</span> <span class="fu">renderText</span>({ <span class="dv">1</span> <span class="sc">/</span> <span class="fu">currentFib</span>() })</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-109326790.png" class="img-fluid"></p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reactlog
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://rstudio.github.io/reactlog/">Reactlog</a> is an R package that visualizes the reactive graph for a particular Shiny app session. This can be very helpful when trying to debug a large app with a lot of reactivity.</p>
<p><img src="images/clipboard-2440969292.png" class="img-fluid"></p>
</div>
</div>
</div>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<ol type="1">
<li><p>Walk through the k-means clustering example and build a mental model of how it works.</p></li>
<li><p>Add print statements to each reactive code block and test the app. Which blocks are re-run when each input changes?</p></li>
<li><p>Turn on options(shiny.trace = TRUE). What messages are sent between server and browser when an input changes?</p></li>
<li><p>Remove the plotOutput() from the ui. How does this change the execution of reactive code blocks and the messages sent between server and browser?</p></li>
</ol>
</section>
</section>
<section id="advanced-ui" class="level2">
<h2 class="anchored" data-anchor-id="advanced-ui">Advanced UI</h2>
<section id="bslib" class="level3">
<h3 class="anchored" data-anchor-id="bslib">Bslib</h3>
<p><a href="https://rstudio.github.io/bslib/">bslib</a> is a package that expands the user interface toolkit for Shiny. It is particularly helpful for custom theming and dashboard design. Think of it like Shiny UI 2.0.</p>
<p><img src="images/clipboard-3595974704.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrap
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://getbootstrap.com/">Bootstrap</a> is a frontend web framework that Shiny utilizes when it generates the HTML/CSS/JS from the <code>ui</code> object. Web frameworks like Bootstrap exist so that web developers don’t reinvent the wheel each time they create a new project. You don’t need to know anything about Bootstrap to create a Shiny app, but can be helpful if you are a user interface perfectionist. By default shiny utilizes Bootstrap 3, and the bslib package uses Boostrap 5 (the latest version).</p>
</div>
</div>
</div>
</section>
<section id="shinyuieditor" class="level3">
<h3 class="anchored" data-anchor-id="shinyuieditor">ShinyUiEditor</h3>
<p><a href="https://rstudio.github.io/shinyuieditor/">ShinyUiEditor</a> is a package that launches a low-code tool for building a Shiny UI and generating app code. You don’t actually need to install it to use it, you can launch a demo through the package website.</p>
</section>
<section id="htmlwidgets" class="level3">
<h3 class="anchored" data-anchor-id="htmlwidgets">Htmlwidgets</h3>
<p><a href="https://www.htmlwidgets.org/">Htmlwidgets</a> are R packages that enable using Javascript visualization libraries in R. Widgets can be used at the R console and embedded in Shiny apps.</p>
<p>One of the most popular htmlwidget packages to use with Shiny is <a href="https://plotly.com/r/getting-started/">plotly</a>, which is an R package based on the plotlyjs web framework for plotting. There is a freely available book written by the package author Carson Sievert: <a href="https://plotly-r.com/">Interactive web-based data visualization with R, plotly, and shiny</a>.</p>
</section>
<section id="many-many-other-shiny-packages" class="level3">
<h3 class="anchored" data-anchor-id="many-many-other-shiny-packages">Many, many other Shiny packages</h3>
<p>There are many R packages available that extend Shiny in various ways. A nice list of the most popular ones is maintained in the Github repo <a href="https://github.com/nanxstats/awesome-shiny-extensions">nanxstats/awesome-shiny-extensions</a>.</p>
</section>
</section>
<section id="deployment" class="level2">
<h2 class="anchored" data-anchor-id="deployment">Deployment</h2>
<p><img src="images/clipboard-3193985200.png" class="img-fluid"></p>
<section id="shiny-server" class="level3">
<h3 class="anchored" data-anchor-id="shiny-server">Shiny Server</h3>
<p><a href="https://posit.co/products/open-source/shinyserver/">Shiny Server</a> is open source web server software. A single server running Shiny Server can host many shiny apps.</p>
<ol type="1">
<li><a href="https://www.shinyapps.io/">Shinyapps.io</a> is a managed service that runs Shiny Server for you. It’s the easiest way to get started deploying Shiny apps. Deploying is fast and simple through the RStudio IDE. It’s free for 25 hours of hosting per month and paid tiers allow additional hours.</li>
<li>Host Shiny Server on your own server. This will take some IT support or knowledge, but many guides exist or deploying Shiny Server yourself.</li>
</ol>
</section>
<section id="shinylive" class="level3">
<h3 class="anchored" data-anchor-id="shinylive">Shinylive</h3>
<p>Shinylive uses WebR to run a shiny app in the browser. There is no backend server required.</p>
<ol type="1">
<li>The technology is still early and many packages don’t work.</li>
<li>No server involved. Doesn’t work with large data sets.</li>
<li>The R code is run in the browser and therefore the user has access to the entire app’s source code and data.</li>
</ol>
<p>Two ways to use shinylive:</p>
<ul>
<li><p>Create your app on <a href="https://shinylive.io/r/editor/">shinylive.io</a> and use the “Share” button to generate a link to it. All of your app’s code and other assets will be compressed to a string and contained in the generated link. Then simply send this link to a user. This is the easiest way to share a Shiny app but it’s limited to small apps.</p></li>
<li><p>Use the <a href="https://github.com/posit-dev/r-shinylive">shinylive R package</a> to create and host your own static website. This is easy to do in combination with the <a href="https://github.com/quarto-ext/shinylive">shinylive quarto extension</a>.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>